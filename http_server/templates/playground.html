<div class="container" id="playground">
  <div class="row">
    <div class="col-md-12">
      <link rel="stylesheet" href="{{ url_for('static', filename='node_modules/sage-client/css/client.css') }}">
      <link href="{{ url_for('static', filename='node_modules/codemirror/lib/codemirror.css') }}" rel='stylesheet' type='text/css'/>
      <link href="{{ url_for('static', filename='node_modules/yasgui-yasqe/dist/yasqe.css') }}" rel='stylesheet' type='text/css'/>
      <div id='target'></div>

      <script type='text/javascript' src="{{ url_for('static', filename='node_modules/popper.js/dist/umd/popper.min.js') }}"></script>
      <script type='text/javascript' src="{{ url_for('static', filename='node_modules/sage-client/js/jquery.tmpl.min.js') }}"></script>
      <script type='text/javascript' src="{{ url_for('static', filename='node_modules/knockout/build/output/knockout-latest.js') }}" charset="utf-8"></script>
      <script type='text/javascript' src="{{ url_for('static', filename='node_modules/codemirror/lib/codemirror.js') }}"></script>
      <script type='text/javascript' src="{{ url_for('static', filename='node_modules/yasgui-yasqe/dist/yasqe.js') }}"></script>
      <script type='text/javascript' src="{{ url_for('static', filename='node_modules/sage-client/js/rdfstore.js') }}"></script>
      <script type='text/javascript' src="{{ url_for('static', filename='node_modules/sage-client/js/client_frontend.js') }}"></script>
      <script type='text/javascript'>
        jQuery(document).ready(function(){
        frontend = null;
          rdfstore.create({"communication": {
                             "parsers": {
                               "text/html" :           ClientFrontend.rdfaParser,
                               "application/rdf+xml":  ClientFrontend.rdfParser
                             },
                            "precedences": ["text/n3", "text/turtle", "application/rdf+xml", "text/html", "application/json"] }
                          },
                          function(err, store) {
                            frontend = new client_frontend('#target',store);
                            {% for dinfo in datasets %}
                              var ds = "{{ dinfo }}";
                              var parser = new DOMParser;
                              var dom = parser.parseFromString(
                                  '<!doctype html><body>' + ds,
                                  'text/html');
                              var decodedString = dom.body.textContent;
                              var toParse = decodedString.replace(/\'/g,"\"");
                              var dataset = JSON.parse(toParse);
                              var hostname = window.location.href;
                              if (hostname.substr(hostname.length - 1) === "#") {
                                hostname = hostname.slice(0,-2);
                              }
                              else {
                                hostname = hostname.slice(0,-1);
                              }
                              var urlDS = hostname + "{{ url_for('sparql-interface.sparql_query', dataset_name=dinfo["name"]) }}";
                              var html = '<a class="dropdown-item" href="#" title="' + urlDS + '">'+dataset.name+'</a>'
                              jQuery('#datasetList').append(html);
                            {% endfor %}
                            var btns = jQuery('#datasetList')[0].children;
                            jQuery('#sparql-server-text').val(btns[0].title);
                            for (var i = 0; i < btns.length; i++) {
                              btns[i].onclick = function(sender){
                                jQuery('#sparql-server-text').val(sender.target.title);
                              };
                            }
                          });

        });
      </script>
    </div>
  </div>
</div>
